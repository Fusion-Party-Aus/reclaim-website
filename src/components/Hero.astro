---
import { Icon } from 'astro-icon/components'

interface Props {
  eyebrow?: string
  title: string
  subtitle?: string
  stats?: Array<{ number: string; label: string }>
  showCTA?: boolean
}

const { eyebrow, title, subtitle, stats, showCTA = false } = Astro.props
---

<section
  class="relative bg-black text-white overflow-hidden"
  style="padding-top: calc(6rem + 48px); padding-bottom: 5rem; border-bottom: 8px solid #5EFFD8;"
>
  {/* ===== Triple colour stripe top edge ===== */}
  <div class="absolute top-0 left-0 w-full h-3 bg-magenta z-20"></div>
  <div class="absolute top-3 left-0 w-full h-2 bg-mint z-20"></div>
  <div class="absolute top-5 left-0 w-full h-1 bg-yellow z-20"></div>

  {/* ===== Geometric corner accents ===== */}
  <div
    class="absolute bottom-0 right-0 w-72 h-72 bg-magenta border-t-8 border-l-8 border-black hidden md:block"
    style="clip-path: polygon(100% 0, 100% 100%, 0 100%);"
  >
  </div>
  <div
    class="absolute top-16 right-16 w-28 h-28 border-8 border-mint hidden md:block"
    style="transform: rotate(22deg);"
  >
  </div>
  <div
    class="absolute top-24 left-12 w-16 h-16 border-6 border-yellow hidden lg:block"
    style="transform: rotate(-12deg);"
  >
  </div>

  {/* ===== Big background watermark letter ===== */}
  <div
    class="absolute inset-0 flex items-center justify-center pointer-events-none select-none overflow-hidden"
  >
    <span
      class="text-[22rem] font-black uppercase leading-none text-white"
      style="font-family: 'Anton', sans-serif; opacity: 0.03; transform: rotate(-6deg);"
      >{title.charAt(0)}</span
    >
  </div>

  <div class="relative z-10 max-w-6xl mx-auto text-center px-4 md:px-8">
    {
      eyebrow && (
        <div class="inline-block mb-6">
          <div
            class="text-xs md:text-sm font-black uppercase tracking-widest px-5 py-2 border-4 border-mint bg-black flex items-center gap-2"
            style="color: #5EFFD8; box-shadow: 4px 4px 0px 0px #5EFFD8;"
          >
            <Icon name="mdi:bullhorn" class="w-4 h-4" />
            {eyebrow}
          </div>
        </div>
      )
    }

    <h1
      class="text-4xl sm:text-5xl md:text-7xl lg:text-8xl font-black mb-6 md:mb-8 leading-[0.9] uppercase relative px-4"
      style="font-family: 'Archivo Black', sans-serif; letter-spacing: 0.01em;"
    >
      <span class="relative inline-block">
        <!-- Offset shadow tuned for Archivo Black's wide letterforms -->
        <span
          class="absolute inset-0 text-magenta"
          style="transform: translate(5px, 5px); opacity: 0.7;">{title}</span
        >
        <span class="relative z-10 text-white">{title}</span>
      </span>
    </h1>

    {
      subtitle && (
        <div class="mb-8 md:mb-12 max-w-3xl mx-auto">
          <p class="text-lg md:text-2xl font-black uppercase leading-tight px-6 py-1 text-left border-l-8 border-yellow text-yellow">
            {subtitle}
          </p>
        </div>
      )
    }

    {
      stats && stats.length > 0 && (
        <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6 md:gap-8 my-12 md:my-16 max-w-5xl mx-auto px-4">
          {stats.map((stat, index) => {
            const colorConfigs = [
              {
                bg: '#C926F2',
                shadow: '#FFED00',
                text: '#FFFFFF',
                iconBg: '#000000',
                iconColor: '#FFFFFF',
                icon: 'mdi:trending-up',
                rotate: '-1deg',
              },
              {
                bg: '#5EFFD8',
                shadow: '#C926F2',
                text: '#000000',
                iconBg: '#000000',
                iconColor: '#5EFFD8',
                icon: 'mdi:account-group',
                rotate: '0.5deg',
              },
              {
                bg: '#FFED00',
                shadow: '#5EFFD8',
                text: '#000000',
                iconBg: '#000000',
                iconColor: '#FFED00',
                icon: 'mdi:cash-multiple',
                rotate: '-0.5deg',
              },
            ]
            const config = colorConfigs[index % 3]

            return (
              <div
                class="stat-card p-6 md:p-8 border-8 border-black transition-all duration-200 hover:-translate-y-2 hover:rotate-0 group relative"
                style={`background-color: ${config.bg}; box-shadow: 8px 8px 0px 0px ${config.shadow}; transform: rotate(${config.rotate});`}
              >
                {/* Brutal corner stripe */}
                <div class="absolute top-0 right-0 w-full h-3 bg-black" />

                <div class="relative z-10 mt-2">
                  <div
                    class="mb-4 inline-block p-3 border-6 border-black"
                    style={`background-color: ${config.iconBg}; box-shadow: 4px 4px 0px 0px ${config.shadow};`}
                  >
                    <Icon
                      name={config.icon}
                      class="w-10 h-10"
                      style={`color: ${config.iconColor};`}
                    />
                  </div>
                  <div
                    class="text-5xl md:text-6xl lg:text-7xl font-black mb-3 uppercase leading-none"
                    style={`color: ${config.text}; font-family: 'Archivo Black', sans-serif; text-shadow: 3px 3px 0px rgba(0,0,0,0.2);`}
                  >
                    {stat.number}
                  </div>
                  <div
                    class="text-xs md:text-sm font-black uppercase tracking-widest leading-tight border-t-4 border-black pt-3 mt-2"
                    style={`color: ${config.text};`}
                  >
                    {stat.label}
                  </div>
                </div>
              </div>
            )
          })}
        </div>
      )
    }

    {
      showCTA && (
        <div class="flex flex-col sm:flex-row gap-4 justify-center items-center mt-8 md:mt-12 px-4">
          <a
            href="/get-involved"
            class="btn btn-primary btn-lg w-full sm:w-auto text-center inline-flex items-center justify-center gap-3"
          >
            <Icon name="mdi:hand-heart" class="w-6 h-6" />
            JOIN THE FIGHT
          </a>
          <a
            href="/manifesto"
            class="btn btn-secondary btn-lg w-full sm:w-auto text-center inline-flex items-center justify-center gap-3"
          >
            <Icon name="mdi:book-open" class="w-6 h-6" />
            READ THE PLAN
          </a>
        </div>
      )
    }

    <slot />
  </div>
</section>

<style>
  .stat-card {
    transform-origin: center;
  }

  .stat-card:hover {
    cursor: pointer;
  }

  @media (max-width: 640px) {
    .stat-card {
      transform: none !important;
    }

    .stat-card:hover {
      transform: scale(1.02) !important;
    }
  }
</style>
